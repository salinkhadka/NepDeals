# ============================================================
# NepDeals E-COMMERCE BACKEND - ENVIRONMENT CONFIGURATION
# ============================================================
# This file serves as a template for environment variables.
# Copy to .env and fill in your values.
# IMPORTANT: Never commit .env with real secrets to Git!
# ============================================================

# ============================================================
# SERVER CONFIGURATION
# ============================================================
# Port on which the backend server runs
PORT=5000

# Environment type: development, staging, production
NODE_ENV=development

# Frontend URL for CORS and redirects
FRONTEND_URL=http://localhost:5173

# Backend server URL
BACKEND_URL=http://localhost:5000

# ============================================================
# DATABASE CONFIGURATION
# ============================================================
# MongoDB connection URI
# For local development: mongodb://localhost:27017/NepDeals
# For Atlas: mongodb+srv://username:password@cluster.mongodb.net/NepDeals
MONGODB_URI=mongodb://localhost:27017/NepDeals

# ============================================================
# JWT AUTHENTICATION
# ============================================================
# JWT Secret Key (Generate: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))")
JWT_SECRET=cd10edb9b247046dd3db7c7bb736e44966822f2ba83caff7779f9786c98f6cede8ae64ef40cd797ce369df385fcd75690411198d1465a3d0d6d1dcec4b66708f

# JWT Token Expiration (e.g., 7d, 24h, 60m)
JWT_EXPIRE=7d

# ============================================================
# ENCRYPTION
# ============================================================
# AES-256-GCM Encryption Key (Generate: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
# Used for encrypting sensitive fields (phone, address, etc.)
ENCRYPTION_KEY=c662dee9c1b11cd08f024eed4dc1b1cde63916ac3804084d04a592a1e22ef366

# ============================================================
# EMAIL CONFIGURATION
# ============================================================
# SMTP Server Host
EMAIL_HOST=smtp.gmail.com

# SMTP Server Port (587 for TLS, 465 for SSL)
EMAIL_PORT=587

# Email account username/address
EMAIL_USER=your-email@gmail.com

# Email account password or app password (for Gmail: use App Password)
EMAIL_PASS=your-app-password

# Sender email address displayed in emails
EMAIL_FROM=noreply@NepDeals.com

# ============================================================
# GOOGLE RECAPTCHA V3
# ============================================================
# Get these from: https://www.google.com/recaptcha/admin
# reCAPTCHA v3 requires both Site Key and Secret Key

# Public key for reCAPTCHA (embedded in frontend)
GOOGLE_RECAPTCHA_SITE_KEY=6LfT_z4sAAAAAKizoLxBgxf99FI5wH8kRlcQS1Rl

# Secret key for verification (server-side only, NEVER expose)
GOOGLE_RECAPTCHA_SECRET_KEY=6LfT_z4sAAAAAKizoLxBgxf99FI5wH8kRlcQS1Rl

# reCAPTCHA score threshold (0.0 - 1.0)
# Lower = stricter (more human-like required)
RECAPTCHA_SCORE_THRESHOLD=0.5

# ============================================================
# ESEWA PAYMENT GATEWAY
# ============================================================
# eSewa Merchant ID (Get from eSewa)
ESEWA_MERCHANT_ID=EPAYTEST

# eSewa Secret Key (NEVER expose, server-side only)
ESEWA_SECRET_KEY=8gBm/:&EnhH.1/q@

# eSewa API Endpoint (test or production)
# Test: https://uat.esewa.com.np/epay/main
# Production: https://epay.esewa.com.np/epay/main
ESEWA_API_URL=https://uat.esewa.com.np/api/epay/main/v2/form

# Success redirect URL (after successful payment)
ESEWA_SUCCESS_URL=http://localhost:5173/payment-success

# Failure redirect URL (after failed payment)
ESEWA_FAILURE_URL=http://localhost:5173/payment-failure

# ============================================================
# FILE UPLOAD CONFIGURATION
# ============================================================
# Maximum file upload size (in bytes)
# 5MB = 5 * 1024 * 1024 = 5242880
MAX_FILE_SIZE=5242880

# Allowed file types (comma-separated MIME types)
ALLOWED_FILE_TYPES=image/jpeg,image/png,image/webp,application/pdf

# Upload directory path (relative to project root)
UPLOAD_DIR=backend/uploads

# ============================================================
# SECURITY SETTINGS
# ============================================================
# Password requirements
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_UPPERCASE=true
PASSWORD_REQUIRE_LOWERCASE=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_SYMBOLS=true

# Brute force protection
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=1800000  # 30 minutes in milliseconds

# Password expiration (in days)
PASSWORD_EXPIRY_DAYS=60

# Session duration (in milliseconds)
SESSION_DURATION=604800000  # 7 days

# CSRF token validity
CSRF_TOKEN_VALIDITY=3600000  # 1 hour

# Rate limiting
RATE_LIMIT_WINDOW_MS=60000  # 1 minute
RATE_LIMIT_MAX_REQUESTS_AUTH=100
RATE_LIMIT_MAX_REQUESTS_ANON=20

# ============================================================
# REDIS CONFIGURATION
# ============================================================
# NOTE: Redis is OPTIONAL - the application uses in-memory + MongoDB
# Only configure if you want to use Redis for distributed caching
# For local development, you can leave these empty/disabled

# Redis Host (leave empty to disable)
REDIS_HOST=

# Redis Port
REDIS_PORT=6379

# Redis Password (if secured)
REDIS_PASSWORD=

# ============================================================
# LOGGING CONFIGURATION
# ============================================================
# Log level: error, warn, info, http, debug, silly
LOG_LEVEL=debug

# Log directory
LOG_DIR=backend/logs

# Enable request logging (morgan)
REQUEST_LOGGING=true

# ============================================================
# API DOCUMENTATION
# ============================================================
# Swagger/API documentation URL path
API_DOCS_PATH=/api-docs

# Enable API documentation (true/false)
ENABLE_API_DOCS=true

# ============================================================
# DEVELOPMENT TOOLS
# ============================================================
# Enable debug mode (verbose console output)
DEBUG=false

# Enable CORS for all origins (development only)
CORS_ALLOW_ALL=false

# ============================================================
# NOTES FOR SECURE CONFIGURATION
# ============================================================
# 1. Generate JWT_SECRET:
#    node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
#
# 2. Generate ENCRYPTION_KEY:
#    node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# 3. For Gmail SMTP:
#    - Enable 2FA on your Google account
#    - Generate App Password: https://myaccount.google.com/apppasswords
#    - Use the 16-character app password
#
# 4. For reCAPTCHA:
#    - Register at: https://www.google.com/recaptcha/admin
#    - Create a new site with reCAPTCHA v3
#    - Copy Site Key and Secret Key
#
# 5. For eSewa:
#    - Test merchant ID: EPAYTEST with secret: 8gBm/:&EnhH.1/q@
#    - Production requires real credentials from eSewa
#
# 6. MongoDB:
#    - Local: Use default connection string above
#    - Atlas: Create cluster and get connection string with your credentials
#
# 7. Security Best Practices:
#    - Use strong, random values for secrets
#    - Rotate secrets periodically
#    - Use different secrets for dev, staging, production
#    - Never commit .env file to Git
#    - Use .gitignore to exclude .env
#    - Store secrets in secure vaults in production
# ============================================================
